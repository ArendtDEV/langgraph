# CLAUDE.md — 영화제작사 타이쿤 (FM 스타일)

> 목적: **FM 시리즈의 UX·시스템 철학을 그대로 차용**해, 사용자가 **영화 제작사 대표**가 되어 스튜디오를 운영·성장시키는 싱글플레이어 경영 시뮬레이션을 만든다. **모든 업무는 ‘수신함(Inbox)’에서 결정**되고, **한 턴=하루**가 흐르며, 달력 오버레이로 다음 일정이 흘러가는 것이 **명확하게 시각화**된다.

---

## 0) 개발 모드(엔진) 선택

* **1순위: Godot 4** (GDScript/C#)

  * 장점: 경량, 커스텀 렌더/UI, 탄탄한 상태머신·리소스 시스템, 배포 간편.
  * 용도: 풀스크린/창 모드 PC 게임.
* **2순위(대안): Tauri/Electron + React + TypeScript + SQLite** ← 이 문서는 **대안을 중심**으로 상세 명세.

  * Tauri 권장(경량/네이티브 패키징, Rust 백엔드 레이어 사용 가능). Electron은 보조.
  * 장점: 웹 UI 생산성, shadcn/ui·TanStack Table 등 강력한 생태계, 데이터툴 구축 용이.
  * 공통 철학: **동일한 게임 로직을 ‘순수 TS 패키지(코어 시뮬)’로 분리**해 Godot/웹 어디든 이식 가능.

### 러닝 룰

* 모든 설계는 **FM식 ‘데이터·보고서·결정’ 루프**를 우선.
* **속성은 1\~20 스케일**(가중·가치·훈련 난이도 포함), **히든 속성** 존재.
* **결정은 수신함에서** 승인/거절/위임으로 처리. 대부분의 화면은 **읽고 링크로 이동**.
* **시간 경과: 하루 단위 틱(tick)**. 밤 00:00에 배치 처리(메일 생성, 일정 갱신, 보고서 산출, 재무 반영, 피로/사기 업데이트 등).

---

## 1) 최상위 UX 구조

### 사이드바(좌) — *FM 레이아웃 준수*

* **홈**(요약 대시보드)
* **수신함**(기본 진입점)
* **스튜디오**(제작사 페이지: 비전·조직·성과·트로피)
* **프로젝트**(영화/시리즈 카탈로그 + 진행/개발/보류)
* **인물**

  * 배우 / 감독 / 제작 / 촬영 / 편집 / VFX / 음악 / 미술 / 마케팅 / 법무 / 재무 / 홍보 / 현장
* **스카우트 & 에이전시**(관찰/리포트/영입 명단)
* **일정**(달력·촬영 스케줄·페스티벌·마케팅)
* **재정**(현금흐름·예산·급여·부채/투자·스폰서)
* **데이터 센터**(성과 분석·예측·시장 리포트)
* **대회/페스티벌**(오스카, 칸, 지역 영화제 등)
* **세트피스? → 캠페인**(런칭, 트레일러, PR, 시사)
* **설정/세이브/불러오기**

### 상단 바

* **진행하기(▶)** — 누르면 **상단 달력 오버레이**가 펼쳐져 당일\~차일 이벤트 타일이 좌→우로 스크롤(참고: 제공된 스샷). 진행 중 스낵팁/로그라인 표시.
* **현재 날짜/시즌**, 속도 토글(보통/빠름), **게임 메시지 토글**.
* 우측: 자금, 평판, 활성 경고 뱃지.

### 수신함 중앙 3칼럼 레이아웃

* **좌**: 메일 목록(필터: 전체/프로젝트/스카우트/재정/HR/법무/이벤트)
* **중앙**: 메일 본문(카드형 위젯: 리포트·스카우팅 카드·계약 제안·이슈 해결)
* **우**: 관련 인물/프로젝트 사이드 패널(요약, 속성 스파이더 차트, 리스크, 추천 행동)
* 각 메일은 **즉시 결정 버튼**(수락/협상/위임/나중에) 제공. 결정이 **달력·DB에 즉시 반영**.

### 달력 오버레이(다음 턴 진행)

* 주간 레인: **프로덕션/마케팅/페스티벌/회의/마감** 칩.
* 각 칩 호버시 툴팁(확률·리스크·담당자·소요비용). **진행 중 애니메이션 라인**이 날짜를 가르킴.

---

## 2) 핵심 게임 루프(하루 틱)

1. **입력**: 수신함 결정, 일정 변경, 계약/예산 조정.
2. **시뮬**:

   * 일정 실행(개발/프리/본촬영/후반/배급/마케팅/페스티벌).
   * **능력치 기반 성과 샘플링**(시나리오 품질, 씬 생산성, 리테이크율, 품질 지표, 버짓 소모, 일정 변동).
   * **리스크 이벤트**(지연, 건강, 날씨, 로케이션 이슈, 조합 규정, 법무 이슈).
   * **학습/성장**(경험치→속성 미세증가, 멘토링, 트레이닝/워크샵 효과).
   * **시장**(경쟁 개봉작, 트렌드, SNS 버즈, 예고편 임팩트).
3. **산출**:

   * 신규 메일 생성(리포트, 경고, 제안, 뉴스), 대시보드 KPI 갱신.
   * 재무 반영(지출·수입·현금잔고·예측 업데이트).

---

## 3) 세계·도메인 모델(요약)

### 엔티티 핵심(★는 페이지 보유)

* **Studio★**: 평판, 비전, 본사/시설, 임직원, 스폰서, 파이프라인, 포트폴리오.
* **Project★**: *Film* 또는 *Series*. 상태(개발/프리/본촬영/후반/완료/배급/아카이브), 장르, 등급, 러닝타임, 타깃, 예상 개봉일, **품질(Quality 1\~100)**, 위험도, 현금흐름.
* **Person★**: 공통 인물(배우/감독/스태프/임원). 속성(아래). 계약/에이전트/언어/가용성/페이/버프/성향/관계망.
* **Role**: 직무(감독, 프로듀서, 라인프로듀서, 촬영감독, 조명, 미술, 분장, 의상, 음향, 음악, VFX, CG 슈퍼, 편집, 컬러리스트, 마케팅, PR, 법무, 재무 등).
* **Agency**: 에이전시/매니지먼트. 수수료, 협상 성향.
* **Contract**: 출연/스태프/외주/로케이션/장비/배급/투자. 금액, 옵션(박스오피스 보너스/크레딧/독점), 기간.
* **Schedule★**: 캘린더(씬 단위/에라 단위), 종속성, 리소스 배정, 버퍼, 크런치 규칙.
* **Scene**: 난이도, 필요 리소스(캐스트/스태프/세트/장비/VFX), 촬영일수, 리테이크 확률.
* **Set/Location**: 비용, 가용 기간, 날씨/리스크.
* **Asset**: 장비/소품/의상/프롭/음원/플러그인.
* **Finance★**: 예산 항목, 거래(General Ledger), 부채/투자, 급여, 스폰서, 세금.
* **Festival/Award★**: 출품 규정, 마감, 선정 확률, 수상 보정치.
* **Market**: 지역별 박스오피스 계수, 취향, 시즌성.
* **News/Inbox★**: 이벤트, 제안, 보고서, 경고. 결정(Action) 내장.
* **Analytics★**: 예측(BO/스트리밍 시청·ROI), 성과 지표, 리스크 매트릭스.

### 인물 속성(1\~20, FM식)

* **기술/직능**: 연기/연출/촬영/편집/VFX/음악/미술/조명/현장/마케팅/PR/법무/재무 등 직무별.
* **정신**: 리더십, 승부욕, 기강, 동기부여, 협업(팀워크), 집중, 판단, 창의성(Flair).
* **신체/컨디션**: 지구력(장시간 근무 내성), 피로회복(타고난 체력), 현장 적응(Adaptability), 건강리스크.
* **정보/분석**(스카우트/분석가용): 데이터분석, 시장이해, 트렌드 감지.
* **히든**: 꾸준함, 중요행사 퍼포먼스(시사회/페스티벌), 더티(무리수/논란), 부상성향→**번아웃 성향**, 협상 성향, 스캔들 리스크.
* **평판/명성**: 지역/장르별 가중치, 상 수상 경력.
* **CA/PA 모델**: 현재능력(1~~200)·잠재능력(1~~200, 일부 음수 랜덤 범위 -10\~-5 지원). **역할·분배 로직**으로 실제 체감에 영향.

### 프로젝트 품질 계산(개요)

* **시나리오 점수**: 작가/감독/장르 적합도, 리라이트 횟수, 커버리지 리포트.
* **제작 점수**: 주요 스태프 평균치(역할 가중), 촬영·미술 난이도 적합, 일정지연 패널티.
* **후반 점수**: 편집/음악/VFX/컬러/믹스.
* **시장 적합도**: 타깃/등급/시기/경쟁작 대비 포지셔닝.
* 최종 **Quality 1\~100**로 환산(정규화), 분산 포함.

---

## 4) 시스템 모듈(상세)

### A. 수신함 시스템

* 소스: 스케줄러, 스카우트, HR, 재무, 법무, 마케팅, 뉴스.
* 유형: 보고서, 제안(계약/영입/외주), 경고(지연/초과/리스크), 퍼포먼스(데일리/위클리), 소식.
* 각 메일은 **Action**을 포함(수락/거절/재협상/보류/위임). 실행 시 **DB 트랜잭션**.
* 필터, 규칙(자동 분류/자동 위임), 고정, 스레드.

### B. 스카우트 & 에이전시

* 스카우트 배정(국가/장르/역할/예산/기간). 정보력·적응력에 따라 **보고서 정확도/속도**.
* **보고서**: 속성 범위→정밀화, 장단점, 요구 페이 범위, 최근 퍼포먼스 샘플, 협업 시너지 후보.
* **영입 명단**: 우선도, 리마인더, 입찰 워크플로.

### C. 계약/협상

* 제안 구성: 기본 페이, 출연료/주당/프로젝트, 보너스(흥행·수상·속행 옵션), 크레딧, 일정/현장 조건, buyout/독점.
* **협상 엔진**: 협상력, 명성, 자금, 대안시장, 관계, 에이전시 성향으로 **수락확률** 산출.

### D. 일정·촬영·후반 파이프라인

* **워크브레이크다운(WBS)**: 개발→프리→본촬영→후반→배급→마케팅.
* **씬 단위** 캘린더(리소스 배정 검사, 충돌/가용성 체크).
* **PERT/베타 분포**로 촬영일 변동 샘플링, 리테이크율은 감독·연기·준비도에 영향.
* **연속성/리소스 종속성**(세트/소품/배우 동시 필요)으로 재배치 비용.
* **버퍼/크런치 규칙**: 과도한 크런치는 **번아웃↑ 품질↓**.

### E. 후반/마케팅·배급/페스티벌

* 후반: 컷 잠정품질→테스트 스크리닝→리마스터/리컷 옵션 비용-효과.
* 마케팅: 캠페인(티저, 트레일러, 포스터, 인터뷰, 시사회, SNS). **버즈 지수**와 **관객 인지** 모델.
* 배급: 지역별 개봉전략(와이드/리미티드, 시즌, 회차), 스트리밍 딜, 해외 프리세일.
* 페스티벌: 출품 마감·선정확률(품질·장르·연출평판·네트워크), 수상 시 **평판/ROI 계수** 보정.

### F. 재무

* 예산(프로젝트/부서/월)과 **지출 승인 플로우**(수신함 결재).
* 일일 회계 배치: 급여, 외주, 세트/장비 렌트, 여행, 세금, 수입(BO, MG, 라이선스).
* **ROI/현금예측**(3·6·12개월), 경고 임계치.

### G. 인재 개발(훈련/워크샵/멘토링)

* 워크샵(연기/연출/편집툴 등) 배정 → 속성 미세상승(확률적)·히든 교정(꾸준함 등).
* 멘토 그룹(시니어→주니어) → 성격/태도 영향.

### H. 데이터 센터(분석)

* 박스오피스 예측(선형·베이지안 혼합, 경쟁·버즈·리뷰 반영).
* **시너지 모델**: 배우×감독, 촬영×미술 상호작용 계수.
* 리스크 매트릭스(영향×가능성), 최적화 제안(재배치/교체/리컷/캠페인 증액).

---

## 5) UI 상세 사양(React 기준)

### 공통

* **디자인 키트**: shadcn/ui + Tailwind. 아이콘: lucide-react. 차트: Recharts.
* **테이블**: TanStack Table(컬럼 핀, 가상 스크롤, 열 토글, 다중 정렬). 수천 행 대응.
* **토스트/모달**: 글로벌 포털. 단축키: FM 유사.

### 페이지 스펙 요약

* **수신함**: 3열. 좌측 목록(카테고리·읽음·핀·스레드). 중앙 본문(카드 컴포지션). 우측 콘텍스트(요약/스파이더/결정 버튼).
* **달력 오버레이**: 상단 풀폭, 주간 레일, 드래그로 기간 조정, 진행 애니메이션, 다이얼로그로 상세.
* **인물 프로필**: 좌: 사진/기본정보/국가/에이전시. 중: 속성 그리드(색 강도), 최근 성과 타임라인, 속성 스파이더. 우: 장단점/적합 롤/요구조건, 계약.
* **스튜디오 페이지**: 비전목표/성과그래프/조직도/핵심 KPI/트로피. 하단: 현재 주요 프로젝트 카드.
* **프로젝트 페이지**: 상단 상태 바(개발→프리→촬영→후반→배급). 좌 탭: 팀/일정/예산/리스크/리뷰/캠페인. 중앙: 컨텐츠. 우: 경고·추천.
* **스카우트 센터**: 우선순위 보드, 후보 리스트, 비교(2\~3인 열 비교), 리포트 품질 게이지.
* **재정**: 현금흐름 라인, 항목별 썬버스트, 급여/외주 히트맵, FFP 유사 제약(보수적으로 안내).
* **데이터 센터**: 예측 그래프, 민감도(토네이도 차트), A/B 캠페인 결과.

---

## 6) 기술 설계 — Tauri + React + SQLite

### 모듈 구조(모노레포)

```
apps/
  desktop/          # Tauri(프론트 React)
packages/
  sim-core/         # 순수 TS 시뮬레이션 코어(엔진 불문 공용)
  data-access/      # DB 클라이언트(Drizzle ORM/Better-SQLite3) & 리포지토리
  ui-kit/           # 공통 컴포넌트(shadcn 확장)
  domain/           # 타입·스키마·유즈케이스
```

### 상태·아키텍처

* 전역 상태: **Zustand**(Redux 대체), Undo/Redo 스택(최대 N, 메모리 관리).
* 커맨드 버스: `execute(command)` → DB/시뮬 → 이벤트 버스(pub/sub) → UI 업데이트.
* 저장: SQLite 파일(버전드 마이그레이션, **세이브 슬롯**). 내보내기/가져오기(JSON 스냅샷).
* Tauri Rust 백엔드: 파일 I/O, 성능 집약 쿼리, 장기 시뮬 배치(옵션).

### 주요 라이브러리

* DB: **SQLite + Drizzle ORM**(스키마-퍼스트, 마이그레이션 자동).
* 성능: workerize/Comlink로 **시뮬 코어 WebWorker 분리**.
* 그래프: Recharts, d3-scale.
* 국제화: i18next. 저장: zod 스키마 검증.

### DB 스키마(요약 DDL)

```sql
-- 인물
CREATE TABLE person (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  kind TEXT NOT NULL,          -- actor/director/staff/executive
  nationality TEXT,
  reputation INTEGER DEFAULT 0,
  agency_id TEXT,
  traits JSON,
  hidden JSON,                 -- consistency, big_event, burnout, scandal_risk ...
  attributes JSON,             -- map of role->1..20
  ca INTEGER, pa INTEGER,      -- 1..200
  availability JSON            -- date ranges
);

CREATE TABLE agency (
  id TEXT PRIMARY KEY,
  name TEXT,
  toughness INTEGER,           -- 협상 강도 1..20
  regions JSON
);

-- 프로젝트
CREATE TABLE project (
  id TEXT PRIMARY KEY,
  title TEXT,
  type TEXT,                   -- film/series
  genre TEXT,
  rating TEXT,
  status TEXT,                 -- dev/pre/prod/post/dist/archive
  target_audience TEXT,
  release_target DATE,
  quality REAL DEFAULT 0,
  risk REAL DEFAULT 0,
  studio_id TEXT
);

CREATE TABLE project_role (
  project_id TEXT,
  person_id TEXT,
  role TEXT,
  contract_id TEXT,
  PRIMARY KEY(project_id, person_id, role)
);

CREATE TABLE contract (
  id TEXT PRIMARY KEY,
  counterparty_type TEXT,      -- person/agency/vendor/distributor
  counterparty_id TEXT,
  project_id TEXT,
  base_fee INTEGER,
  bonus JSON,                  -- awards/boxoffice options
  start DATE, end DATE,
  terms JSON
);

-- 일정/씬
CREATE TABLE schedule (
  id TEXT PRIMARY KEY,
  project_id TEXT,
  start DATE, end DATE,
  kind TEXT,                   -- dev/pre/shoot/post/marketing/festival
  payload JSON
);

CREATE TABLE scene (
  id TEXT PRIMARY KEY,
  project_id TEXT,
  difficulty INTEGER,
  needs JSON,                  -- cast, crew, set, vfx, gear
  planned_days REAL,
  retake_prob REAL
);

-- 재무
CREATE TABLE ledger (
  id TEXT PRIMARY KEY,
  date DATE,
  project_id TEXT,
  account TEXT,
  amount INTEGER,              -- +수입 / -지출
  memo TEXT
);

-- 인박스/뉴스
CREATE TABLE inbox (
  id TEXT PRIMARY KEY,
  date DATE,
  category TEXT,
  title TEXT,
  body JSON,
  actions JSON,                -- [{type:'accept', command:'Offer.Accept', args:{...}}, ...]
  read INTEGER DEFAULT 0
);
```

> 세부 컬럼·인덱스·FK는 Drizzle 마이그레이션에 정의. 모든 JSON은 **zod 스키마**로 엄격 검증.

### 시뮬레이션 코어(순수 TS)

* `tick(day: Date, world: WorldState): WorldStateChanges` — **결정적**(seed 기반 RNG).
* 서브모듈: `scheduling`, `quality`, `risk`, `finance`, `scout`, `negotiation`, `marketing`, `festival`.
* 표준 분포 유틸: 정규, 베타, 삼각, 로그노말. 민감도 파라미터 테이블.

### 성능·세이브

* 대규모 리스트 가상화(테이블/메일). DB는 **READONLY 트랜잭션 캐시** 및 **배치 쓰기**.
* 세이브 슬롯: 파일명에 버전/타임스탬프, 자동 백업.

---

## 7) 알고리즘 개요(포뮬러 스케치)

### 품질(Quality)

```
Quality = clamp01( w_script*S + w_prod*P + w_post*H ) * 100
S = f(writer, director, script_rewrite, genre_fit, coverage)
P = f(coreCrewWeightedMean, scheduleVariancePenalty, retakeCost)
H = f(edit, music, vfx, color, mix, testScreeningFeedback)
```

### 박스오피스 예측(개봉 전)

```
BO0 = base(genre, marketSeason) * starPower * campaignBuzz * reviewPred
DailyDecay = lognormal(mu, sigma)
CompetitionFactor = product(1 - overlap_i)
Forecast = sum_t ( BO0 * decay(t) ) * CompetitionFactor * regionCoeffs
```

### 협상 수락확률

```
P(accept) = σ( a0 + a1*offerValueIndex + a2*reputation + a3*relationship
                 + a4*agencyToughness*(-1) + a5*urgency )
```

### 일정 지연 확률(씬)

```
Delay ~ Beta(α(difficulty, prep), β(adaptability, leadership))
Retake ~ Bernoulli(p = g(director, actor, scene_complexity))
```

---

## 8) 테스트·툴링

* **시뮬 단위테스트**: vitest + seed 고정 스냅샷.
* **프로퍼티 테스트**: fast-check (예산 보존, 음수 금지 등 불변식).
* **시나리오 스위트**: ‘저예산 인디’, ‘하이콘셉트 블록버스터’, ‘페스티벌 스윕’.
* **데이터 팩**: CSV/YAML 임포터(모드 지원). 샌드박스 UI.

---

## 9) 접근성·지역화·모딩

* 폰트 크기 스케일, 컬러 블라인드 팔레트, 키보드 네비게이션.
* i18n: `ko` 기본, `en`/`ja` 확장. 날짜·통화 로캘.
* **모딩**: `/mods`에 데이터팩/이미지/룰 JSON 투입 → 런타임 로드(서명·검증).

---

## 10) 저장/로드·버전 관리

* `meta{ gameVersion, schemaVersion }` 포함. 마이그레이션 전략(세이브 열 시 자동 변환 + 백업).
* 크래시 세이프: 저널 모드 `WAL` 사용. 주기적 자동저장(일/주 단위 옵션).

---

## 11) 수치 테이블 가이드

* 속성 평균 8~~12, 스타는 14~~16, 레전드는 17\~20(희귀).
* 훈련 난이도/비용 가중치: 속도형(피로회복 등)은 **코스트↑**.
* 히든은 드문 이벤트로 소폭 변동.

---

## 12) 제작 일정(마일스톤)

1. **스프린트 0**: 모노레포/DB/시뮬 코어 스캐폴드, 수신함/달력 MVP.
2. **스프린트 1**: 인물·속성·스카우트·리포트.
3. **스프린트 2**: 프로젝트 파이프라인(개발→후반), 일정·씬 편집기.
4. **스프린트 3**: 계약/협상, 재무 MVP.
5. **스프린트 4**: 마케팅/페스티벌, 데이터 센터 예측.
6. **폴리시·밸런싱**: 튜토리얼, 난이도, 세이브/모딩, 현지화.

---

## 13) CLAUDE 작업지시 템플릿

> 아래 템플릿으로 모듈 단위 코드를 생성·수정·리뷰한다. 출력은 **실행 가능한 TS/SQL/React** 위주, 테스트 포함.

### (A) 시뮬 코어 함수 구현 요청

```
역할: 시뮬레이션 코어 개발자
목표: [함수명] 구현/수정
입력: 타입 정의, 수학식/의사코드, 경계조건
산출물: TS 코드, 단위테스트(vitest), 주석 포함
제약: 순수함수, PRNG는 seedrandom 주입, 성능 O(n log n) 이하
```

### (B) DB 스키마/마이그레이션

```
역할: 데이터 엔지니어
목표: [테이블/인덱스] 추가/변경
산출물: Drizzle 스키마와 마이그레이션, 역방향 스크립트
검증: zod 스키마, 샘플 INSERT, 쿼리 예시
```

### (C) UI 컴포넌트

```
역할: 프론트엔드
목표: [컴포넌트명] 제작(FM 스타일)
구성: props, 상태, 접근성, 단축키
산출물: TSX + 스타일(Tailwind), 스토리북 스토리, 스냅샷 테스트
```

### (D) 기능 수락기준(예시: 수신함)

* 목록 가상 스크롤 10k건에서 60fps
* 필터/스레드/핀/읽음 토글
* 본문 내 **결정 버튼**이 커맨드 실행→DB 반영→토스트→목록 리프레시
* 단축키: J/K 이동, E 읽음 토글, Enter 열기

---

## 14) FM→영화 도메인 매핑(참고)

* **선수**→**배우/스태프**, **감독(Manager)**→**스튜디오 대표/쇼러너**
* **전술**→**제작 전략/캠페인 전략**
* **훈련**→**워크샵/멘토링**
* **의료센터**→**복지/컨디션/번아웃 관리**
* **대회**→**페스티벌/시상식**
* **경기**→**개봉/상영/시사회**

---

## 15) 튜토리얼 흐름(요약)

1. 수신함에서 **첫 프로젝트 제안** 수락 → 2) 스카우트로 캐스팅 후보 확보 → 3) 계약·일정 편성 → 4) 촬영 데일리 리포트 확인·리스크 대응 → 5) 후반/캠페인 → 6) 개봉/페스티벌 → 7) 리뷰·성장.

---

## 16) 품질 바 기준(UI)

* 어두운 테마, 콘트라스트 준수. 스샷처럼 **좌 사이드바 + 우 상단 진행**.
* **레이더/스파이더 차트**(속성)와 **테이블 비교**(FM 스타일 강조 표시) 기본 제공.

---

## 17) 보안/세이프가드

* Tauri 권한 최소화, 파일 경로 샌드박스. 세이브 암호화(선택).
* 크래시리포트 옵트인. 모드 로딩 검증(서명·스키마 체크).

---

## 18) 아트·사운드 가이드(간략)

* UI: 얇은 폰트, 카드 그림자 최소, 팀 컬러=스튜디오 컬러.
* SFX: 수신함 도착/결정/경고, 달력 진행 ‘틱’ 소리.

---

### 끝.

> 본 문서는 **Tauri/React/TS/SQLite 대안 설계**를 기준으로 작성. 동일 로직을 `packages/sim-core`로 격리해 Godot 4 포팅을 간단화한다.

